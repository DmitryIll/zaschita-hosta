# Домашнее задание к занятию  «Защита хоста» - Илларионов Дмитрий

### Задание 1

1. Установите **eCryptfs**.
2. Добавьте пользователя cryptouser.
3. Зашифруйте домашний каталог пользователя с помощью eCryptfs.



*В качестве ответа  пришлите снимки экрана домашнего каталога пользователя с исходными и зашифрованными данными.*  

#### Решение

* установил:

```
apt install ecryptfs-utils
```
Создал пользователя:

```
adduser --encrypt-home cryptouser
```

![alt text](image.png)

Переключаемся на пользователя:

![alt text](image-1.png)


Просмотр домашнего каталога:

![alt text](image-2.png)

Полезная информация:
![alt text](image-3.png)

Пока не примонтируем - нет доступа к домашнему каталогу:

![alt text](image-4.png)

Монтируем:

```
ecryptfs-mount-private
```
![alt text](image-5.png)

![alt text](image-6.png)

Интересно, что что бы получить доступ нужно было выполнить команду CD заново:

![alt text](image-7.png)

Или еще в чем-то причина была не понятно.

В общем можно зайти в шифрованную папку создать файл и содержимое:

![alt text](image-8.png)

![alt text](image-9.png)

Выходим из пользователя возвращаемся в root:

![alt text](image-10.png)

И ничего не видим - файла 123 нет.

Еще попытки что-то найти в других папках:

![alt text](image-11.png)

Все зашифровано - следов нет.


### Задание 2

1. Установите поддержку **LUKS**.
2. Создайте небольшой раздел, например, 100 Мб.
3. Зашифруйте созданный раздел с помощью LUKS.

*В качестве ответа пришлите снимки экрана с поэтапным выполнением задания.*

Смотрю какие есть разделы сейчас:

![alt text](image-12.png)

Создал новый раздел (старый ужал на 1 Gb что бы место было):

![alt text](image-14.png)

в df -h -не отображается:

![alt text](image-15.png)

Хотя уже и так установлен, но, пробую установить:

![alt text](image-16.png)

Проверяем версию:
![alt text](image-17.png)

Настраиваем шифрование на созданном разделе:
![alt text](image-18.png)

Открываем (подготавливаем к рабоете) зашифрованный раздел:
![alt text](image-19.png)

Заполняем нулями новый раздел - вычищаем мусор (для безопасности):
![alt text](image-20.png)

В "зашифрованном слое" внутри создаем файловую систему - размечаем диск:
![alt text](image-21.png)

Создаю папку и примонтирую содержимое раздела в нее:
![alt text](image-22.png)

Теперь что-то запишем в свой файл:
![alt text](image-23.png)

Теперь завершим работу с данными:
![alt text](image-24.png)

Хоть мы и отмонтировали раздел от паппки:
![alt text](image-25.png)

Но, данные еще доступны на чтение в расшифрованном виде:
![alt text](image-27.png)

Удается что-то прочитать:
![alt text](image-26.png)


Поэтому закрываем "соединение" с разделом:
![alt text](image-29.png)


После этого прочитать уже нельзя:
![alt text](image-28.png)

Что бы потом опять прочитать - опять выполняем:
![alt text](image-13.png)

И т.д.

## Дополнительные задания (со звёздочкой*)

Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале

### Задание 3 *

1. Установите **apparmor**.
2. Повторите эксперимент, указанный в лекции.
3. Отключите (удалите) apparmor.


*В качестве ответа пришлите снимки экрана с поэтапным выполнением задания.*



